"use client";
import { RefObject, useRef } from "react";
import gsap from "gsap";
import { useGSAP } from "@gsap/react";
import { DrawSVGPlugin } from "gsap/DrawSVGPlugin";

gsap.registerPlugin(DrawSVGPlugin, useGSAP);

function Preloader( {preloaderRef} :{preloaderRef:RefObject<null>}) {
  const svgRef = useRef<SVGSVGElement>(null);
  useGSAP(
    () => {
      const paths = svgRef.current?.querySelectorAll("path");

      if (!paths || paths.length === 0) return;

      // Store original fills and reset
      paths.forEach((path) => {
        const originalFill = path.getAttribute("fill") || "#000";
        path.setAttribute("data-original-fill", originalFill);
        path.setAttribute("stroke", originalFill);
        path.setAttribute("fill", "transparent");
        path.setAttribute("stroke-width", "3");
      });

      const tl = gsap.timeline({ defaults: { ease: "power3.inOut" } });

      // 1. Draw strokes
      tl.fromTo(
        paths,
        { drawSVG: "0%" },
        {
          drawSVG: "100%",
          duration: 2.5,
          stagger: 0.02,
        }
      );

      // 2. Fill color fade-in
      tl.to(
        paths,
        {
          fill: (i, target) => target.getAttribute("data-original-fill"),
          duration: 1,
          stagger: 0.02,
        },
        "-=1.2" // start fading in before draw ends
      );

      // 3. Remove stroke after fill
      tl.to(
        paths,
        {
          stroke: "transparent",
          duration: 0.3,
      
        },
        "-=0.5"
      );
    },
    { scope: svgRef }
  );

  return (
    <div ref={preloaderRef} className="bg-[#E7E8E2] text-[#E7E8E2] w-full h-screen">
      <div className="flex items-center justify-center h-full">
        <svg
          width="485"
          height="491"
          viewBox="0 0 485 491"
          fill="none"
          ref={svgRef}
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M239.078 0.068071C254.894 -0.769854 267.952 6.25282 281 14.2556C282.152 14.9613 282.152 14.9613 283.328 15.6814C286.626 17.71 289.916 19.7494 293.198 21.8042C301.387 26.9222 309.686 31.8437 318 36.7556C326.886 42.0076 335.749 47.2811 344.5 52.7556C353.11 58.139 361.823 63.3357 370.562 68.5056C383.707 76.2829 396.789 84.1567 409.83 92.1059C414.536 94.974 419.245 97.8351 423.957 100.693C426.91 102.485 429.863 104.278 432.813 106.074C438.364 109.454 443.925 112.812 449.52 116.119C451.067 117.041 451.067 117.041 452.645 117.981C454.548 119.114 456.455 120.238 458.368 121.352C470.313 128.496 479.823 136.96 483.496 150.685C485.616 161.497 482.965 170.875 476.988 179.955C471.565 186.23 465.143 190.656 458 194.756C456.229 195.795 454.46 196.837 452.691 197.881C451.766 198.426 450.841 198.971 449.887 199.533C444.858 202.534 439.898 205.644 434.938 208.756C433.926 209.389 432.915 210.023 431.873 210.676C425.575 214.629 419.286 218.596 413 222.568C411.86 223.288 411.86 223.288 410.697 224.022C406.908 226.416 403.121 228.814 399.34 231.22C397.873 232.149 396.405 233.077 394.938 234.006C394.264 234.437 393.59 234.867 392.896 235.311C388.227 238.256 388.227 238.256 386 238.256C386 246.506 386 254.756 386 263.256C397.432 256.99 408.489 250.27 419.52 243.326C425.775 239.389 432.057 235.496 438.351 231.622C440.021 230.594 441.69 229.564 443.359 228.535C446.234 226.766 449.116 225.009 452 223.256C452.699 222.818 453.398 222.381 454.118 221.931C459.217 218.831 463.17 218.31 469 219.256C475.058 222.227 480.038 227.594 482.492 233.955C484.59 243.46 483.795 253.734 479 262.256C473.701 269.908 467.13 274.418 459.162 278.987C454.607 281.66 450.159 284.508 445.688 287.318C443.585 288.634 441.482 289.949 439.379 291.263C435.261 293.84 431.144 296.418 427.027 298.998C415.504 306.214 403.947 313.373 392.36 320.486C386.046 324.367 379.756 328.282 373.5 332.256C365.039 337.629 356.507 342.88 347.965 348.123C340.622 352.633 333.302 357.179 326 361.756C315.402 368.395 304.764 374.969 294.102 381.506C290.293 383.841 286.495 386.193 282.711 388.568C265.511 399.326 249.611 405.041 229.109 401.603C212.911 397.372 199.01 386.984 185.026 378.16C180.573 375.357 176.101 372.585 171.625 369.818C170.782 369.296 169.938 368.775 169.07 368.237C163.218 364.619 157.357 361.015 151.496 357.414C141.975 351.563 132.47 345.689 123 339.756C106.432 329.378 89.7757 319.147 73.0625 309.006C65.4687 304.396 57.9232 299.721 50.4343 294.943C45.7764 291.98 41.0824 289.084 36.3555 286.232C35.1885 285.525 34.0215 284.818 32.8547 284.111C30.5984 282.743 28.3363 281.387 26.0691 280.037C13.9241 272.674 4.95817 265.283 0.999992 251.256C0.0675939 240.818 0.687675 232.992 7.43749 224.881C10.3468 221.613 12.8347 219.657 17.1914 218.849C24.8904 218.545 29.6139 221.199 36 225.256C37.3942 226.127 38.7888 226.998 40.1836 227.869C43.4146 229.895 46.6354 231.936 49.8516 233.986C66.0826 244.318 82.5515 254.275 99 264.256C100.856 250.04 100.856 250.04 96.3442 237.119C91.7259 233.355 86.3072 231.045 80.8965 228.636C76.0063 226.305 71.5772 223.296 67.0625 220.318C65.2116 219.129 63.3588 217.943 61.5039 216.759C60.5901 216.176 59.6763 215.592 58.7349 214.99C54.3469 212.207 49.9237 209.482 45.5 206.756C43.7772 205.688 42.0545 204.62 40.332 203.552C37.5843 201.849 34.8328 200.154 32.0718 198.472C29.1021 196.663 26.1443 194.836 23.1875 193.006C22.2864 192.464 21.3854 191.921 20.457 191.363C12.3025 186.276 4.84197 179.632 1.63671 170.306C-0.759828 158.824 0.171778 148.842 5.58984 138.467C11.1597 130.258 19.9092 125.172 28.3125 120.318C30.5422 119.005 32.7713 117.691 35 116.377C35.5734 116.04 36.1469 115.704 36.7377 115.357C42.5514 111.944 48.3135 108.449 54.0705 104.942C55.8179 103.877 57.566 102.814 59.3144 101.752C61.6747 100.318 64.0347 98.883 66.3945 97.448C72.5327 93.7153 78.6723 89.9849 84.8125 86.2556C85.4107 85.8922 86.0088 85.5289 86.6251 85.1546C94.0346 80.6546 101.456 76.1756 108.895 71.7243C114.672 68.2573 120.428 64.7537 126.187 61.2556C126.785 60.8924 127.383 60.5293 127.999 60.1551C133.562 56.7761 139.124 53.3959 144.686 50.0148C148.29 47.8238 151.895 45.6331 155.5 43.4431C156.089 43.0851 156.678 42.7272 157.285 42.3584C165.284 37.5003 173.291 32.6567 181.33 27.8674C185.629 25.3011 189.905 22.7023 194.157 20.0587C196.633 18.5199 199.115 16.9891 201.596 15.4585C202.8 14.7131 204.001 13.9639 205.199 13.2104C215.917 6.47319 226.369 1.21477 239.078 0.068071Z"
            fill="#FE882E"
          />
          <path
            d="M151.171 92.9882C152.381 92.9814 152.381 92.9814 153.615 92.9744C156.31 92.9618 159.004 92.9634 161.698 92.9651C163.634 92.9591 165.569 92.9523 167.504 92.9447C172.757 92.927 178.009 92.9223 183.261 92.9211C186.545 92.9196 189.828 92.9154 193.112 92.9101C204.574 92.8916 216.036 92.8834 227.498 92.885C238.171 92.8862 248.845 92.8651 259.518 92.8335C268.69 92.8073 277.862 92.7966 287.035 92.7979C292.509 92.7984 297.983 92.7927 303.457 92.7715C308.609 92.7521 313.76 92.752 318.911 92.7666C320.797 92.7687 322.683 92.764 324.568 92.7518C337.181 92.676 347.547 93.1023 357.242 102.189C362.581 108.465 365.116 115.656 365.14 123.794C365.146 124.921 365.152 126.048 365.158 127.209C365.159 129.058 365.159 129.058 365.161 130.944C365.166 132.245 365.171 133.546 365.176 134.887C365.189 138.455 365.196 142.024 365.2 145.592C365.203 147.825 365.207 150.058 365.212 152.29C365.225 159.285 365.235 166.279 365.239 173.274C365.243 181.331 365.261 189.387 365.29 197.444C365.312 203.682 365.322 209.92 365.323 216.158C365.324 219.878 365.33 223.599 365.348 227.319C365.367 231.477 365.363 235.634 365.356 239.791C365.366 241.011 365.375 242.231 365.384 243.489C365.332 254.289 363.63 263.247 356 271.256C351.115 275.716 346.28 278.267 340 280.256C339.142 280.539 339.142 280.539 338.266 280.829C334.852 281.472 331.456 281.33 327.997 281.27C326.331 281.251 324.664 281.232 322.998 281.214C322.115 281.202 321.233 281.191 320.324 281.18C314.634 281.118 308.943 281.118 303.253 281.107C298.269 281.094 293.287 281.059 288.303 280.978C283.467 280.9 278.634 280.883 273.798 280.904C271.969 280.901 270.14 280.878 268.311 280.832C254.543 280.504 246.811 283.628 236.571 292.864C234.532 294.67 232.362 296.251 230.133 297.814C229.465 298.295 228.796 298.777 228.108 299.272C227.453 299.741 226.799 300.21 226.125 300.693C224.616 301.779 223.107 302.865 221.598 303.951C220.844 304.493 220.09 305.034 219.313 305.592C216.168 307.854 213.027 310.121 209.887 312.39C208.355 313.496 206.821 314.601 205.287 315.703C202.028 318.048 198.784 320.402 195.602 322.849C194.64 323.582 193.678 324.314 192.688 325.068C191.887 325.693 191.086 326.318 190.262 326.963C187.497 328.543 186.128 328.907 183 328.256C180.642 326.122 179.188 324.374 178.652 321.18C178.537 318.637 178.551 316.125 178.609 313.58C178.615 312.655 178.621 311.729 178.627 310.776C178.649 307.831 178.699 304.888 178.75 301.943C178.77 299.942 178.788 297.942 178.805 295.941C178.849 291.045 178.918 286.151 179 281.256C178.088 281.277 177.176 281.297 176.237 281.319C172.802 281.388 169.368 281.438 165.932 281.475C164.455 281.495 162.978 281.522 161.502 281.557C149.158 281.842 138.8 280.515 129.008 272.302C119.455 262.564 118.7 251.054 118.709 238.092C118.703 236.8 118.696 235.507 118.689 234.176C118.672 230.655 118.667 227.135 118.665 223.614C118.664 221.409 118.66 219.204 118.654 216.999C118.636 209.291 118.628 201.583 118.629 193.875C118.631 186.714 118.609 179.553 118.578 172.391C118.552 166.221 118.541 160.051 118.542 153.881C118.543 150.205 118.537 146.53 118.516 142.854C118.493 138.752 118.502 134.651 118.514 130.549C118.497 128.744 118.497 128.744 118.48 126.904C118.552 117.222 120.552 109.008 127.297 101.787C134.352 95.4436 141.723 92.9489 151.171 92.9882Z"
            fill="#FCF8F4"
          />
          <path
            d="M471.125 303.881C478.739 310.17 483.013 317.232 484.238 327.193C484.609 337.481 480.894 346.724 474 354.256C467.877 360.265 461.259 364.891 453.938 369.318C451.803 370.63 449.669 371.943 447.535 373.256C446.451 373.918 445.367 374.581 444.251 375.263C439.106 378.417 433.99 381.617 428.875 384.818C427.881 385.439 426.887 386.06 425.863 386.699C419.221 390.851 412.604 395.042 406 399.256C395.394 406.023 384.73 412.695 374.054 419.351C357.171 429.878 340.31 440.437 323.516 451.103C311.141 458.954 298.678 466.66 286.173 474.3C283.971 475.657 281.783 477.026 279.603 478.416C273.853 482.063 268.48 485.227 261.938 487.193C260.709 487.573 259.481 487.954 258.215 488.345C257.154 488.646 256.093 488.946 255 489.256C254.359 489.457 253.719 489.658 253.059 489.865C228.522 494.521 208.568 480.702 189.012 468.099C182.729 464.061 176.37 460.153 170 456.256C161.953 451.326 153.947 446.344 146 441.256C136.891 435.423 127.697 429.739 118.476 424.085C109.684 418.689 100.948 413.209 92.2403 407.678C81.29 400.725 70.3126 393.817 59.3125 386.943C57.8133 386.005 57.8133 386.005 56.2837 385.049C51.0375 381.77 45.7852 378.502 40.5235 375.248C39.4622 374.589 38.4009 373.931 37.3074 373.253C35.3006 372.008 33.2918 370.767 31.2805 369.53C16.6934 360.47 4.43723 352.577 0.250022 335.131C-0.537421 326.075 0.307516 318.576 5.64846 310.881C9.29961 306.544 12.5714 302.864 18.3321 301.841C26.0723 301.244 30.8922 303.85 37.2051 308.066C39.1645 309.365 41.1485 310.617 43.1406 311.865C46.3311 313.863 49.5141 315.873 52.6914 317.892C58.3404 321.477 64.0123 325.025 69.6875 328.568C70.6959 329.198 71.7043 329.827 72.7432 330.476C74.8019 331.762 76.8606 333.047 78.9195 334.332C84.9438 338.093 90.9656 341.859 96.9878 345.623C102.05 348.787 107.112 351.95 112.176 355.111C114.221 356.388 116.267 357.666 118.313 358.943C119.317 359.57 120.321 360.197 121.356 360.844C127.376 364.606 133.38 368.391 139.375 372.193C146.876 376.947 154.431 381.61 162 386.256C169.569 390.901 177.123 395.565 184.625 400.318C185.363 400.785 186.101 401.251 186.861 401.732C190.232 403.865 193.601 406.001 196.964 408.145C200.139 410.168 203.319 412.181 206.5 414.193C207.479 414.82 208.458 415.447 209.467 416.094C223.226 424.772 236.364 430.628 252.941 427.744C262.869 424.913 271.402 418.779 280 413.256C281.734 412.153 283.468 411.051 285.203 409.951C288.881 407.615 292.555 405.273 296.227 402.927C302.127 399.165 308.061 395.457 314 391.756C321.692 386.961 329.36 382.132 337 377.256C345.714 371.694 354.468 366.198 363.239 360.727C372.516 354.939 381.761 349.104 391 343.256C394.062 341.317 397.124 339.38 400.188 337.443C400.96 336.955 401.732 336.467 402.527 335.964C406.952 333.169 411.385 330.389 415.828 327.623C416.831 326.998 417.834 326.374 418.867 325.73C420.907 324.46 422.946 323.191 424.987 321.922C429.947 318.826 434.879 315.698 439.762 312.482C441.12 311.588 441.12 311.588 442.506 310.675C444.202 309.553 445.894 308.426 447.582 307.291C455.542 302.02 462.21 299.245 471.125 303.881Z"
            fill="#FE882E"
          />
          <path
            d="M170.933 137.102C172.83 137.089 172.83 137.089 174.765 137.076C176.174 137.071 177.584 137.067 178.993 137.063C180.471 137.055 181.95 137.047 183.428 137.038C188.29 137.012 193.153 136.996 198.016 136.982C199.689 136.977 201.362 136.971 203.036 136.966C209.996 136.944 216.957 136.926 223.917 136.914C233.895 136.898 243.873 136.865 253.851 136.808C260.865 136.769 267.879 136.75 274.893 136.744C279.083 136.741 283.272 136.729 287.462 136.696C291.405 136.666 295.348 136.66 299.291 136.672C300.737 136.672 302.182 136.664 303.628 136.646C315.91 136.505 315.91 136.505 319.844 139.667C323.204 143.701 323.356 146.003 323 151.256C321.175 155.482 319.075 157.225 315 159.256C312.072 159.633 312.072 159.633 308.776 159.637C307.522 159.645 306.269 159.653 304.978 159.662C303.596 159.656 302.215 159.65 300.834 159.644C299.373 159.648 297.913 159.653 296.452 159.66C292.491 159.673 288.531 159.668 284.57 159.659C280.423 159.651 276.276 159.658 272.129 159.663C265.165 159.668 258.202 159.661 251.238 159.647C243.189 159.63 235.141 159.636 227.092 159.652C220.179 159.666 213.266 159.668 206.353 159.66C202.225 159.655 198.098 159.655 193.97 159.664C190.089 159.673 186.209 159.667 182.328 159.65C180.904 159.646 179.481 159.647 178.058 159.654C176.113 159.662 174.169 159.65 172.224 159.637C171.137 159.635 170.049 159.634 168.928 159.633C164.795 159.1 162.198 157.371 159.187 154.568C157.431 151.147 157.218 147.96 158 144.256C161.344 138.496 164.518 137.134 170.933 137.102Z"
            fill="#FE842B"
          />
          <path
            d="M169.49 180.102C170.435 180.093 171.38 180.084 172.353 180.076C173.913 180.069 173.913 180.069 175.505 180.063C176.598 180.055 177.69 180.046 178.816 180.038C182.445 180.013 186.074 179.997 189.703 179.982C191.559 179.974 191.559 179.974 193.453 179.966C198.653 179.945 203.853 179.926 209.053 179.914C216.502 179.898 223.95 179.865 231.399 179.808C237.27 179.765 243.141 179.749 249.012 179.742C251.508 179.736 254.004 179.72 256.5 179.696C259.993 179.665 263.484 179.665 266.977 179.672C268.525 179.647 268.525 179.647 270.105 179.622C274.689 179.662 277.967 179.717 281.626 182.667C284.436 185.731 284.938 186.438 285.25 190.568C284.98 194.555 284.537 196.211 282 199.256C276.564 202.84 271.599 202.688 265.316 202.66C263.72 202.67 263.72 202.67 262.092 202.68C258.582 202.699 255.072 202.695 251.562 202.689C249.119 202.694 246.676 202.699 244.233 202.705C239.115 202.714 233.997 202.712 228.88 202.702C222.323 202.69 215.766 202.71 209.209 202.74C204.164 202.758 199.12 202.758 194.076 202.752C191.658 202.752 189.24 202.758 186.822 202.77C183.442 202.785 180.063 202.774 176.684 202.757C175.686 202.767 174.688 202.777 173.661 202.787C167.793 202.724 164.492 202.123 160 198.256C157.409 194.84 157.497 191.422 158 187.256C160.968 182.312 163.78 180.14 169.49 180.102Z"
            fill="#FE842B"
          />
          <path
            d="M172.627 222.981C173.39 222.976 174.153 222.971 174.939 222.965C177.458 222.952 179.977 222.952 182.496 222.955C184.25 222.951 186.003 222.947 187.757 222.942C191.431 222.934 195.105 222.935 198.779 222.94C203.485 222.946 208.19 222.929 212.896 222.906C216.517 222.891 220.138 222.89 223.759 222.893C225.494 222.893 227.228 222.887 228.963 222.877C231.39 222.865 233.817 222.872 236.244 222.883C236.958 222.876 237.673 222.868 238.409 222.86C242.779 222.906 245.535 223.561 249 226.256C251.668 230.258 251.834 233.549 251 238.256C248.818 241.011 247.128 242.691 244 244.256C241.524 244.364 239.077 244.413 236.6 244.417C235.456 244.424 235.456 244.424 234.289 244.432C231.759 244.446 229.229 244.453 226.699 244.459C224.943 244.464 223.186 244.47 221.43 244.476C217.744 244.486 214.058 244.492 210.371 244.496C205.65 244.501 200.929 244.525 196.208 244.554C192.578 244.572 188.949 244.578 185.319 244.579C183.579 244.582 181.838 244.59 180.098 244.603C177.661 244.62 175.225 244.619 172.788 244.612C172.07 244.621 171.353 244.63 170.613 244.64C166.232 244.603 163.503 243.909 160 241.256C157.434 237.834 157.636 234.409 158 230.256C159.218 227.515 160.153 225.836 162.633 224.136C165.946 222.904 169.139 222.969 172.627 222.981Z"
            fill="#FE842A"
          />
        </svg>
      </div>
    </div>
  );
}

export default Preloader;

